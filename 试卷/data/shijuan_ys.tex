\usepackage[utf8]{inputenc}

\usepackage[paperwidth=36.8cm,paperheight=26cm,
top=2cm,bottom=2cm,right=2cm,left=3.cm,
columnsep=1.5cm]{geometry}
\columnseprule=.4pt

\usepackage{bbding}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{wasysym}
\usepackage{makeidx}

\usepackage{graphicx}
\usepackage{setspace}
\usepackage{tabu}
\usepackage{paralist}
\usepackage{lastpage}
\usepackage{enumerate} 

\usepackage{fancyhdr}
\renewcommand{\headrulewidth}{0pt}
\pagestyle{fancy}
\fancyfoot[CO,CE]{第~\thepage~页~~共~\pageref{LastPage}~页}
\fancyhead[RE]{\leavevmode\vbox to0pt{
		\vss\rlap{\putzdxx }\vskip -26cm }} %奇数页眉的右边                       
\fancyhead[LO]{\leavevmode\vbox to0pt{
		\vss\rlap{\putzdx }\vskip -26cm }} %偶数页眉的左边 

\newsavebox{\zdxa}%装订线

\sbox{\zdxa}
{\parbox{27cm}{\centering \heiti \hspace{1cm}
		班~级：\underline{\makebox[45mm][c]{}}~~~ 姓~名：\underline{\makebox[30mm][c]{}}~~~ 学~号：\underline{\makebox[30mm][c]{}} \\
		\vspace{1mm}
%		请在所附答题纸上空出密封位置。并填写试卷序号、班级、学号和 姓名\\
		%答题时学号
%		\vspace{1mm}
	  \dotfill{} 〇 \dotfill{} 密\dotfill{}封\dotfill{}线\dotfill{}〇\dotfill{} \\
}}
\newsavebox{\zdxb}%装订线
\sbox{\zdxb}
{\parbox{27cm}{\centering \heiti
		\vspace{30mm}
		\vspace{1mm}
		\dotfill{} 〇 \dotfill{}密\dotfill{}封\dotfill{}线\dotfill{}〇\dotfill{} \\
}}

\newcommand{\putzdx}{
		\hspace{-1.7cm}\parbox{1cm}{\vspace{-1.5cm}
			\rotatebox[origin=c]{90}{
				\usebox{\zdxa}
		}}
}
\newcommand{\putzdxx}{
	\hspace{0.3cm}\parbox{1cm}{\vspace{-1.5cm}
		\rotatebox[origin=c]{-90}{
			\usebox{\zdxb}
	}}
}


\usepackage{ifthen}

%选择题选项命令 \xx
\usepackage{ifthen}
%\usepackage{enumitem}
\setlength{\parsep}{0ex}
\setlength{\itemsep}{0ex}
\setlength{\leftmargin}{6mm}
\setlength{\topsep}{0ex}

\usepackage{geometry}

\newlength{\testxxla}
\newlength{\testxxlb}
\newlength{\testxxlc}
\newlength{\testxxld}
\newlength{\testxxle}
\newlength{\lhalf}
\newlength{\ltrisect}
\newlength{\lquarter}
\newlength{\lfifth}
\newlength{\lmax}

%-----------------------------------------------------------------------------%
% 无标签的两选项，输出方式：一行二选项
%-----------------------------------------------------------------------------%
\newcommand{\testtwo}[2]
{\par
	\setlength{\lhalf}{0.5\linewidth}
	
	\makebox[\lhalf][l]{#1~~~}%
	\makebox[\lhalf][l]{#2~~~}%
	
}
%-----------------------------------------------------------------------------%
% 四选项，根据选项的长度自动判断输出方式：一行一选项，一行二选项，一行四选项
%-----------------------------------------------------------------------------%
\newcommand{\testxx}[4]
{
	\par
	\settowidth{\testxxla}{A.~#1~~~}
	\settowidth{\testxxlb}{B.~#2~~~}
	\settowidth{\testxxlc}{C.~#3~~~}
	\settowidth{\testxxld}{D.~#4~~~}
	\ifthenelse{\lengthtest{\testxxla>\testxxlb}}{\setlength{\lmax}{\testxxla}}{\setlength{\lmax}{\testxxlb}}
	\ifthenelse{\lengthtest{\testxxlc>\lmax}}{\setlength{\lmax}{\testxxlc}}{}
	\ifthenelse{\lengthtest{\testxxld>\lmax}}{\setlength{\lmax}{\testxxld}}{}
	\setlength{\lhalf}{0.5\linewidth}
	\setlength{\lquarter}{0.25\linewidth}
	\ifthenelse{\lengthtest{\lmax>\lhalf}}
	{
		\begin{enumerate}
			\item[A.] #1
			\item[B.] #2
			\item[C.] #3
			\item[D.] #4
		\end{enumerate}
	}
	{
		\ifthenelse{\lengthtest{\lmax>\lquarter}}
		{
			\noindent%
			\makebox[\lhalf][l]{A.~#1~~~}%
			\makebox[\lhalf][l]{B.~#2~~~}%
			\par\noindent%
			\makebox[\lhalf][l]{C.~#3~~~}%
			\makebox[\lhalf][l]{D.~#4~~~}%
		}%
		{
			\noindent%
			\makebox[\lquarter][l]{A.~#1~~~}%
			\makebox[\lquarter][l]{B.~#2~~~}%
			\makebox[\lquarter][l]{C.~#3~~~}%
			\makebox[\lquarter][l]{D.~#4~~~}%
		}
	}
}
%-----------------------------------------------------------------------------%
% 五选项，根据选项的长度自动判断输出方式：一行一选项，一行二选项，一行四选项
%-----------------------------------------------------------------------------%
\newcommand{\testxxf}[5]
{
	\par
	\settowidth{\testxxla}{A.~#1~~~}
	\settowidth{\testxxlb}{B.~#2~~~}
	\settowidth{\testxxlc}{C.~#3~~~}
	\settowidth{\testxxld}{D.~#4~~~}
	\settowidth{\testxxle}{E.~#5~~~}
	\ifthenelse{\lengthtest{\testxxla>\testxxlb}}{\setlength{\lmax}{\testxxla}}{\setlength{\lmax}{\testxxlb}}
	\ifthenelse{\lengthtest{\testxxlc>\lmax}}{\setlength{\lmax}{\testxxlc}}{}
	\ifthenelse{\lengthtest{\testxxld>\lmax}}{\setlength{\lmax}{\testxxld}}{}
	\ifthenelse{\lengthtest{\testxxle>\lmax}}{\setlength{\lmax}{\testxxle}}{}
	\setlength{\lhalf}{0.5\linewidth}
	\setlength{\ltrisect}{0.33\linewidth}
	\setlength{\lquarter}{0.25\linewidth}
	\setlength{\lfifth}{0.2\linewidth}
	\ifthenelse{\lengthtest{\lmax>\lhalf}}
	{
		\begin{enumerate}
			\item[A.] #1
			\item[B.] #2
			\item[C.] #3
			\item[D.] #4
			\item[E.] #5
		\end{enumerate}
	}
	{
		\ifthenelse{\lengthtest{\lmax>\ltrisect}}
		{
			\noindent%
			\makebox[\lhalf][l]{A.~#1~~~}%
			\makebox[\lhalf][l]{B.~#2~~~}%
			\par\noindent%
			\makebox[\lhalf][l]{C.~#3~~~}%
			\makebox[\lhalf][l]{D.~#4~~~}%
			\par\noindent%
			\makebox[\lhalf][l]{E.~#5~~~}%
			\makebox[\lhalf][l]{}%
		}
		{
			\ifthenelse{\lengthtest{\lmax>\lquarter}}
			{
				\noindent%
				\makebox[\ltrisect][l]{A.~#1~~~}%
				\makebox[\ltrisect][l]{B.~#2~~~}%
				\makebox[\ltrisect][l]{C.~#3~~~}%
				\par\noindent%
				\makebox[\ltrisect][l]{D.~#4~~~}%
				\makebox[\ltrisect][l]{E.~#5~~~}%
				\makebox[\ltrisect][l]{}%
			}
			{
				\ifthenelse{\lengthtest{\lmax>\lfifth}}
				{
					\noindent%
					\makebox[\lquarter][l]{A.~#1~~~}%
					\makebox[\lquarter][l]{B.~#2~~~}%
					\makebox[\lquarter][l]{C.~#3~~~}%
					\makebox[\lquarter][l]{D.~#4~~~}%
					\par\noindent%
					\makebox[\lquarter][l]{E.~#5~~~}%
					\makebox[\lquarter][l]{}%
					\makebox[\lquarter][l]{}%
					\makebox[\lquarter][l]{}%
				}
				{
					\noindent%
					\makebox[\lfifth][l]{A.~#1~~~}%
					\makebox[\lfifth][l]{B.~#2~~~}%
					\makebox[\lfifth][l]{C.~#3~~~}%
					\makebox[\lfifth][l]{D.~#4~~~}%
					\makebox[\lfifth][l]{E.~#5~~~}%
				}
			}
		}
	}
}
%-----------------------------------------------------------------------------%
% 三选项，根据选项的长度自动判断输出方式：一行一选项，一行二选项，一行三选项
%-----------------------------------------------------------------------------%
\newcommand{\testxxs}[3]
{
	\par
	\settowidth{\testxxla}{A.~#1~~~}
	\settowidth{\testxxlb}{B.~#2~~~}
	\settowidth{\testxxlc}{C.~#3~~~}
	\ifthenelse{\lengthtest{\testxxla>\testxxlb}}{\setlength{\lmax}{\testxxla}}{\setlength{\lmax}{\testxxlb}}
	\ifthenelse{\lengthtest{\testxxlc>\lmax}}{\setlength{\lmax}{\testxxlc}}{}
	\setlength{\lhalf}{0.5\linewidth}
	\setlength{\ltrisect}{0.33\linewidth}
	\ifthenelse{\lengthtest{\lmax>\lhalf}}
	{
		\begin{enumerate}
			\item[A.] #1
			\item[B.] #2
			\item[C.] #3
		\end{enumerate}
	}
	{
		\ifthenelse{\lengthtest{\lmax>\ltrisect}}
		{
			\noindent%
			\makebox[\lhalf][l]{A.~#1~~~}%
			\makebox[\lhalf][l]{B.~#2~~~}%
			\par\noindent%
			\makebox[\lhalf][l]{C.~#3~~~}%
		}%
		{
			\noindent%
			\makebox[\ltrisect][l]{A.~#1~~~}%
			\makebox[\ltrisect][l]{B.~#2~~~}%
			\makebox[\ltrisect][l]{C.~#3~~~}%
		}
	}
}


\makeatletter
\newcommand{\xx@i}[2]{\testtwo{#1}{#2}}
\newcommand{\xx@ii}[3]{\testxxs{#1}{#2}{#3}}
\newcommand{\xx@iii}[4]{\testxx{#1}{#2}{#3}{#4}}
\newcommand{\xx@iv}[5]{\testxxf{#1}{#2}{#3}{#4}{#5}}
\newcommand{\xx@iii@helper}[4]{%
	\@ifnextchar\bgroup
	{\xx@iv{#1}{#2}{#3}{#4}}{\xx@iii{#1}{#2}{#3}{#4}}}
\newcommand{\xx@ii@helper}[3]{%
	\@ifnextchar\bgroup
	{\xx@iii@helper{#1}{#2}{#3}}{\xx@ii{#1}{#2}{#3}}}
\newcommand{\xx}[2]{%
	\@ifnextchar\bgroup
	{\xx@ii@helper{#1}{#2}}{\xx@i{#1}{#2}}}
\makeatother

%填空题画线  \tk
%\newcommand{\tk}[2][2.5]{\; \underline{\hspace{#1 cm} \hphantom{#2} \hspace{#1 cm} } \, }


%判断题后面加括号
\newcommand{\pd}[2][1]{\nolinebreak\dotfill\mbox{\raisebox{-1.8pt}
		{$\cdots$}(\makebox[#1 cm][c]{
		\ifthenelse{\boolean{print}}
		{\ifthenelse{\equal{#2}{t}}{\Checkmark}{\XSolid}}
		{}
		})}}

\newboolean{print}
\setboolean{print}{true}

\usepackage{ulem}
\newcommand{\tk}[2][0.2]{\;\uline{ 
		\hspace*{#1 cm}
		 \ifthenelse{\boolean{print}}{#2}{\hphantom{#2}}  
	 	 \hspace*{#1 cm}
 	 } }
  
\newcommand{\jd}[2][4]{\par
\begin{minipage}[t][#1cm][t]{0.92\linewidth}	
	\ifthenelse{\boolean{print}}{#2}{}  
\end{minipage} 
}	
